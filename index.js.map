{"version":3,"file":"index.js","sources":["../src/js/pagination.js","../src/js/main.js"],"sourcesContent":["export function maxPagination(totalPages, currentPage) {\n  const pages = [];\n  let start, end;\n\n  try {\n    if (totalPages <= 5) {\n      start = 0;\n      end = totalPages - 1;\n    } else if (currentPage <= 2) {\n      start = 0;\n      end = 4;\n    } else if (currentPage >= totalPages - 3) {\n      start = totalPages - 5;\n      end = totalPages - 1;\n    } else {\n      start = currentPage - 2;\n      end = currentPage + 2;\n    }\n\n    for (let i = start; i <= end; i++) {\n      pages.push(i);\n    }\n\n    if (currentPage >= 4 && !pages.includes(0)) {\n      pages.unshift(0);\n    }\n\n    if (end <= totalPages - 2) {\n      pages.push(\"...\");\n      pages.push(totalPages - 1);\n    } else if (end === totalPages - 2) {\n      pages.push(totalPages - 1);\n    }\n\n    return pages;\n  } catch (error) {\n    console.log(`Ошибка в параметрах пагинации: ${error}`);\n  }\n}\n\nexport function renderPagination(totalPages, currentPage, onPageClick) {\n  const pagination = document.querySelector(\".pagination\");\n  pagination.innerHTML = \"\";\n\n  const pages = maxPagination(totalPages, currentPage);\n\n  try {\n    pages.forEach(page => {\n      if (page === \"...\") {\n        const dots = document.createElement(\"span\");\n        dots.textContent = \"...\";\n        dots.classList.add(\"pagination__dots\");\n        pagination.appendChild(dots);\n      } else {\n        const btn = document.createElement(\"button\");\n        btn.textContent = page + 1;\n        btn.classList.add(\"pagination__btn\");\n        if (page === currentPage) {\n          btn.classList.add(\"active\");\n        }\n        btn.addEventListener(\"click\", () => {\n          onPageClick(page);\n        });\n\n        pagination.appendChild(btn);\n      }\n    });\n  } catch (error) {\n    console.log(`Ошибка в рендере пагинации: ${error}`);\n  }\n}","import { renderPagination } from \"./pagination\";\n\nconst events = document.querySelector(\".cards\");\nconst form = document.querySelector(\".header-form\");\nconst searchInput = document.getElementById(\"search\");\n\nlet currentKeyword = \"\";\n\nasync function data(page = 0, keyword = \"\") {\n  currentKeyword = keyword;\n\n  const params = new URLSearchParams({\n    apikey: \"L1jPPLF7E3w1Bs5yPVnSQz5OqfouKgX8\",\n    page,\n    size: 20\n  });\n\n  if (keyword) {\n    params.append(\"keyword\", keyword);\n  }\n\n  const BASE_URL = `https://app.ticketmaster.com/discovery/v2/events.json?${params.toString()}`;\n\n  try {\n    const response = await fetch(BASE_URL);\n    const result = await response.json();\n\n    const eventList = result._embedded?.events || [];\n\n    const validEvents = eventList.filter(card =>\n      card.images.length &&\n      card.name &&\n      card.dates.start.localDate &&\n      card._embedded.venues.length\n    );\n\n    if (validEvents.length === 0) {\n      events.innerHTML = '<p class=\"no-results\">Ничего не найдено</p>';\n      return;\n    }\n\n    let totalPages;\n    if (keyword) {\n      totalPages = Math.min(result.page.totalPages, 5);\n    } else {\n      totalPages = Math.min(result.page.totalPages, 50);\n    }\n\n    let currentPage;\n    if (typeof result.page?.number === \"number\") {\n      currentPage = result.page.number;\n    } else {\n      currentPage = 0;\n    }\n\n    renderPagination(totalPages, currentPage, (page) => data(page, currentKeyword));\n    createCards(validEvents);\n  } catch (error) {\n    console.log(`Ошибка с базой данных: ${error}`);\n  }\n}\n\nconst observer = new IntersectionObserver((entries) => {\n  entries.forEach(entry => {\n    if (entry.isIntersecting) {\n      entry.target.classList.add(\"animate__animated\", \"animate__bounceIn\");\n      observer.unobserve(entry.target)\n    } else {\n      entry.target.classList.remove(\"animate__bounceIn\");\n    }\n  });\n}, {\n  threshold: 0.1\n});\n\nexport function createCards(content) {\n  try {\n    events.innerHTML = '';\n    content.forEach(card => {\n      const parent = document.createElement(\"a\");\n      parent.href = card.url;\n      parent.setAttribute(\"target\", \"_blank\");\n      parent.classList.add(\"card\");\n\n      const cardImg = document.createElement(\"img\");\n      cardImg.src = card.images[0].url;\n      cardImg.alt = card.name;\n      cardImg.classList.add(\"card__img\");\n\n      const cardTitle = document.createElement(\"h2\");\n      cardTitle.textContent = card.name;\n      cardTitle.classList.add(\"card__title\");\n\n      const cardData = document.createElement(\"h5\");\n      cardData.textContent = card.dates.start.localDate;\n      cardData.classList.add(\"card__time\");\n\n      const cardPlace = document.createElement(\"p\");\n      cardPlace.textContent = card._embedded.venues[0].name;\n      cardPlace.classList.add(\"card__place\");\n\n      const rectangle = document.createElement(\"div\");\n      rectangle.classList.add(\"rectangle\");\n\n      parent.append(cardImg, cardTitle, cardData, cardPlace, rectangle);\n      events.append(parent);\n      observer.observe(parent);\n    });\n  } catch (error) {\n    console.log(`Ошибка в генерации карточек: ${error}`);\n  }\n}\n\nform.addEventListener(\"submit\", (e) => {\n  e.preventDefault();\n  const keyword = searchInput.value.trim();\n  data(0, keyword);\n});\n\ndata();"],"names":["maxPagination","totalPages","currentPage","pages","start","end","i","error","renderPagination","onPageClick","pagination","page","dots","btn","events","form","searchInput","currentKeyword","data","keyword","params","BASE_URL","result","validEvents","_a","card","_b","createCards","observer","entries","entry","content","parent","cardImg","cardTitle","cardData","cardPlace","rectangle","e"],"mappings":"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"}